# 클라우드 컴퓨팅?

## 모듈 2 소개

> Amazon Elastic Compute Cloud는 어떤 서비스인지 알아보자

카페 예시에서 클라이언트와 서버 예시를 든 적이 있다.  
클라이언트가 서버에 요청을 보내면 서버가 작업을 수행하고 다시 클라이언트에게 응답을 보내는 모델이다.

여기서는 카페를 예로 들었지만, 동일한 개념이 다양한 분야에서 서버 - 클라이언트 모델이 사용된다.  
의료 서비스, 제조 서비스, 보험 서비스 등을 포함하여 전 세계에 있는 수백만명에게 동영상 컨텐츠를 제공하는 서비스도 제품, 리소스, 데이터를 사용자에게 전달 한다.

`서비스`를 `운영`하기 위해서는 `서버`라는 것이 필요하다.  
이러한 서버를 통해 웹 애플리케이션을 호스팅하고 기업에 필요한 리소스를 제공한다.

AWS에서 사용하는 서버는 물리적인 서버가 아닌, `인터넷을 통해 접근 가능한 가상화된 서버`다.  
이렇듯 `가상화된 서버에 엑세스 하는 서비스를 EC2`라 한다.

EC2는 온프레미스 리소스를 사용하는 것보다 상당히 유용한데 아래 비교군을 보자.

- `온프레미스를 통해 서버를 구축한다면?`
  - 구매할 `서버 유형` 및 `대수`를 검토
  - `H/W 비용 선 결제`
  - 제공 업체에 요청 후 몇달을 기다려야함
  - 데이터 센터에 전선 연결 및 서버 설치 필요
  - 보안 및 전원 연결 확인
  - 단점
    - `사용하든 안하든 구매한 서버 무조건 보유`
- `EC2를 사용하게 된다면?`
  - `AWS`는 이미 `데이터 센터`를 구축하여 `보안` 유지하고 있음
  - 또한 `AWS`는 이미 `서버`를 `모두 구매`해두었음
  - `해당 서버`는 바로 사용 가능한 `온라인 상태`
  - 사용자가 원하는 EC2 인스턴스를 요청, 원하지 않으면 바로 종료 가능
  - `사용한 만큼만 비용 지불`(중지, 종료 -> 비용 안나감)

기본적으로 `EC2`는 `가상화`를 통해 `AWS에서 관리`하고 있다. 또한 `AWS`에서 `관리`하는 `물리적`인 `호스트`에서 `실행`되고 있기 때문에, EC2 인스턴스를 실행할 때 전체 호스트 시스템을 소유할 필요는 없다. 대신 호스트를 다른 사용자와 공유해서 사용한다. (가상머신)

`호스트 머신`에서 실행하는 `하이퍼바이저`라는 것이 가상머신끼리 물리적 리소스를 공유하도록 책임을 진다. 이렇듯 `여러 가상 머신이 기본 하드웨어를 공유`하는 것을 `멀티 테넌시`라 한다. 또한 하이퍼바이저에 의해 각 EC2 인스턴스는 `격리` 된다.

또한 EC2 인스턴스는 `크기 조정` -> `수직 확장`이 가능하며, 네트워크(`보안그룹`)도 제어 가능하다.

## Amazon EC2 인스턴스 유형

> 지금까지는 EC2에 대해 알아보았는데, 이번에는 유형에 대해 알아본다

앞서 카페를 예로 들었는데 EC2 인스턴스는 직원에 해당하며 클라이언트의 요청을 처리한다는 것을 알 수 있다. 수 많은 고객을 상대하려면 직원이 여러명이 필요하다. 여기서 모든 직원이 카운터를 담당하지 않아도 되며 직원들은 각각 맡은 역할을 담당하면 된다.

AWS에는 목적에 따라 `다양한 유형의 EC2 인스턴스를 제공`한다. 각 EC2 유형은 `인스턴스 패밀리`로 구분이 되며, 인스턴스 유형에 따라 `CPU`, `Memory`, `스토리지`, `네트워크 용량` 등 선택 가능. 

- AWS EC2 인스턴스 패밀리
  - 범용
    - CPU, Memory, Network 리소스 균형있음
    - 웹서버
  - 컴퓨팅 최적화
    - CPU 관련 작업
    - 게임 서버
  - 메모리 최적화
    - 메모리 관련 작업
  - 엑셀러레이티드 컴퓨팅
    - 그래픽 처리
    - 머신러닝 모델 학습 적합
  - 스토리지 최적화
    - 대규모 데이터 처리
    - Hadoop or 배치 서비스

## Amazon EC2 요금

> AWS는 얼마나 비용이 발생할까? EC2 인스턴스는 다양한 비용 옵션을 가지고 있는데,  
> 옵션은 아래와 같이 구성이 된다.

- `온디멘드`
  - `인스턴스 실행한 기간 만큼 비용 지불`
  - 선택한 `인스턴스 유형` 및 `OS` 타입에 따라 `시간/초단위`로 과금
  - `선 결재` or `약정` -> 필요 x
- `Savings Plan`
  - `일정한 사용량`을 `약정(1년, 2년)`하는 대가로, `EC2 비용 감축`(72%)
  - 이렇게 되면 `인스턴스 패밀리`, `크기`, `OS`, `테넌시`, `리전` 상관 없이 `비용 감소` 가능
- `Reserved Instance`
  - 꾸준한 상태의 워크로드, 시용량 예측 가능한 워크로드에 적합
  - 온디멘드 대비 -> 75% 저렴
  - 1년 or 3년 약정 -> 할인 가능
- `Spot Instance`
  - AWS의 `여분 인스턴스` 용량 사용
  - 최대 `95%` 할인
  - AWS가 언제든 리소스 가져갈 수 있음, 알람은 줌
  - 주로 배치에서 사용
- `전용 호스트`
  - EC2가 동작하는 `물리적 호스트`를 `전용`으로 사용
  - `다른 사용자`와 `서버 머신을 공유 안함`

## Amazon EC2 크기 조정

> AWS의 확장성 및 탄력성에 대해 기술

![scaling.png](./img/scaling.png)

- 온프레미스 데이터 센테의 딜레마
  - `고객의 워크로드`는 `유동적`이다
  - IDC 구축의 경우 H/W를 얼마나 구매할지가 중요하다
  - `하지만 고객의 수요에 맞게 H/W 장비를 셋팅하는 것은 거의 불가능`하다
- AWS는 어떻게 해소할까?
  - `고객의 워크로드`에 맞게 `유동적 리소스 Scaling` 가능
  - H/A(고가용성) 시스템 구축 가능
- `증가하는 수요의 2가지 처리 방안`
  - 수직 확장
    - 장치의 성능 추가
    - `Scale Up`
  - 수평 확장
    - 장치의 대수를 추가
    - `Scale Out`

## Elastic Load Balancing을 사용하여 트래픽 리다이렉션

> 이번 시간에는 트래픽에 대한 문제가 있는 경우에 대해 알아보자

- ELB(Elastic Load Blancer)
  - `EC2 인스턴스가 여러개 있을 때, 워크로드를 균등하게 분배하기 위해 사용`
    - 서버에 트래픽 몰림 방지를 위해, 부하 분산 처리를 해주는 기술
    - `라운드 로빈`, `가중치 기반 부하 분산`, `IP 해싱 기반 알고리즘` 존재
    - 대표적으로 `ALB:L7`, `NLB:L4`, `CLB` 존재
- 트래픽을 적적할게 분산하기 위해 필요한 것?
  - ELB를 사용하자!
    - 고성능
    - 비용 효율성
    - 고가용성
    - 자동 확장 기능 제공

### ELB는 리전 수준에서 실행

![elb.png](./img/elb.png)

- `ELB`는 `리전 수준` 구조이다
- `리전 수준`에서 `실행`되므로 `자동`으로 `고가용성 서비스`가 된다
- `ELB`는 `자동`으로 `확장` 한다?
  - 트래픽이 증가하면 시간당 비용 변경 없이, 추가 트래픽을 처리하도록 설계
  - 여기서 AutoScaling 서비스는 ELB에 온라인 상태가 가능하다는 신호를 보내고
  - 트래픽이 줄어들면 다시 축소가 되는 구조를 갖는다

### ELB는 외부 트래픽에만 사용하지 않는다

![elb2.png](./img/elb2.png)

- ELB는 외부 통신에만 사용이 되지 않고, 내부 통신에도 사용이 된다
- 위와 같이 ELB가 없으면 내부 통신이 복잡해진다

![elb3.png](./img/elb3.png)

- 하지만 ELB를 중간에 둠으로써 네트워크가 간단해진다

## 메시징 및 대기열

> TODO

## 추가 컴퓨팅 서비스

> TODO

## 모듈 2 요약